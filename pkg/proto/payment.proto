syntax = "proto3";

package openhost.plugin.payment.v1;

option go_package = "github.com/openhost/openhost/pkg/proto/payment/v1;paymentv1";

service PaymentService {
  rpc Charge(ChargeRequest) returns (ChargeResponse);
  rpc Refund(RefundRequest) returns (RefundResponse);
  rpc Subscribe(SubscribeRequest) returns (SubscribeResponse);
  rpc CancelSubscription(CancelSubscriptionRequest) returns (CancelSubscriptionResponse);
}

enum PaymentStatus {
  PAYMENT_STATUS_UNSPECIFIED = 0;
  PAYMENT_STATUS_SUCCEEDED = 1;
  PAYMENT_STATUS_PENDING = 2;
  PAYMENT_STATUS_FAILED = 3;
}

message Money {
  string amount = 1;
  string currency = 2;
}

message ChargeRequest {
  string customer_id = 1;
  Money amount = 2;
  string payment_method_id = 3;
  string description = 4;
  string idempotency_key = 5;
}

message ChargeResponse {
  string transaction_id = 1;
  PaymentStatus status = 2;
  string message = 3;
}

message RefundRequest {
  string transaction_id = 1;
  Money amount = 2;
  string reason = 3;
  string idempotency_key = 4;
}

message RefundResponse {
  string refund_id = 1;
  PaymentStatus status = 2;
  string message = 3;
}

message SubscribeRequest {
  string customer_id = 1;
  string plan_id = 2;
  string payment_method_id = 3;
  Money amount = 4;
  string idempotency_key = 5;
}

message SubscribeResponse {
  string subscription_id = 1;
  PaymentStatus status = 2;
  string message = 3;
}

message CancelSubscriptionRequest {
  string subscription_id = 1;
  string reason = 2;
}

message CancelSubscriptionResponse {
  PaymentStatus status = 1;
  string message = 2;
}
