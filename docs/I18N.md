# Internationalization (i18n) Guide / å›½é™…åŒ–æŒ‡å—

[English](#english) | [ç®€ä½“ä¸­æ–‡](#chinese)

---

<a name="english"></a>
# English

## Overview

OpenHost provides a comprehensive internationalization (i18n) system that supports multiple languages with built-in English and Chinese translations. The system is designed to be easy to use for both developers and translators.

## Quick Start

### Using Translations in Templates

```html
<!-- Simple translation -->
<h1>{{ t "nav.home" }}</h1>

<!-- Translation with parameters -->
<p>{{ t "common.copyright" .Year }}</p>
```

### Switching Languages

Users can switch languages via:
- URL parameter: `?lang=zh`
- Cookie: `lang=zh`
- Accept-Language header

## Architecture

### Translation Structure

Translations are organized in a hierarchical namespace structure:

```
common.           # Common strings used everywhere
nav.              # Navigation labels
auth.             # Authentication-related strings
  login.          # Login page strings
  register.       # Registration page strings
home.             # Homepage content
  hero.           # Hero section
  features.       # Features section
products.         # Products page
pricing.          # Pricing page
cart.             # Shopping cart
checkout.         # Checkout flow
client.           # Client panel
  dashboard.      # Client dashboard
  services.       # Services management
  invoices.       # Invoices
  tickets.        # Support tickets
admin.            # Admin panel
  dashboard.      # Admin dashboard
  customers.      # Customer management
footer.           # Footer content
errors.           # Error messages
validation.       # Form validation messages
```

### Built-in Languages

OpenHost comes with built-in translations for:
- **English (en)** - Default language
- **Chinese (zh)** - ç®€ä½“ä¸­æ–‡

## Adding a New Language

### Step 1: Create Translation File

Create a new file in `internal/infrastructure/i18n/translations_XX.go` where XX is the language code:

```go
package i18n

func myLanguageTranslations() map[string]any {
    return map[string]any{
        "meta": map[string]any{
            "code":        "XX",
            "name":        "Language Name",
            "native_name": "Native Name",
            "direction":   "ltr",  // or "rtl"
            "flag":        "ğŸ‡½ğŸ‡½",
        },
        "common": map[string]any{
            "app_name": "OpenHost",
            // ... more translations
        },
        // ... more namespaces
    }
}
```

### Step 2: Register the Language

Update `i18n.go` to load your language:

```go
func (m *Manager) LoadBuiltinLanguages() error {
    // ... existing code
    if err := m.loadEmbeddedLanguage("XX", myLanguageTranslations()); err != nil {
        return err
    }
    return nil
}
```

### Step 3: Load from External Files (Optional)

For dynamic translations, create JSON files in `./locales/XX/`:

```
locales/
â””â”€â”€ XX/
    â”œâ”€â”€ meta.json
    â”œâ”€â”€ common.json
    â”œâ”€â”€ nav.json
    â”œâ”€â”€ auth.json
    â””â”€â”€ ...
```

Example `meta.json`:
```json
{
  "code": "XX",
  "name": "Language Name",
  "native_name": "Native Name",
  "direction": "ltr",
  "flag": "ğŸ‡½ğŸ‡½"
}
```

Example `common.json`:
```json
{
  "app_name": "OpenHost",
  "app_tagline": "Modern Hosting & Billing Management",
  "loading": "Loading...",
  "save": "Save",
  "cancel": "Cancel"
}
```

## Translation Keys Reference

### Common (common.*)

| Key | English | Chinese |
|-----|---------|---------|
| `common.app_name` | OpenHost | OpenHost |
| `common.app_tagline` | Modern Hosting & Billing Management | ç°ä»£åŒ–ä¸»æœºä¸è´¦å•ç®¡ç†ç³»ç»Ÿ |
| `common.save` | Save | ä¿å­˜ |
| `common.cancel` | Cancel | å–æ¶ˆ |
| `common.delete` | Delete | åˆ é™¤ |
| `common.edit` | Edit | ç¼–è¾‘ |
| `common.view` | View | æŸ¥çœ‹ |
| `common.search` | Search | æœç´¢ |

### Navigation (nav.*)

| Key | English | Chinese |
|-----|---------|---------|
| `nav.home` | Home | é¦–é¡µ |
| `nav.products` | Products | äº§å“ |
| `nav.pricing` | Pricing | ä»·æ ¼ |
| `nav.docs` | Documentation | æ–‡æ¡£ |
| `nav.support` | Support | æ”¯æŒ |
| `nav.login` | Login | ç™»å½• |
| `nav.register` | Sign Up | æ³¨å†Œ |
| `nav.logout` | Logout | é€€å‡ºç™»å½• |
| `nav.dashboard` | Dashboard | æ§åˆ¶é¢æ¿ |

### Authentication (auth.*)

| Key | English | Chinese |
|-----|---------|---------|
| `auth.login.title` | Welcome Back | æ¬¢è¿å›æ¥ |
| `auth.login.email` | Email Address | é‚®ç®±åœ°å€ |
| `auth.login.password` | Password | å¯†ç  |
| `auth.login.submit` | Sign In | ç™»å½• |
| `auth.register.title` | Create Account | åˆ›å»ºè´¦æˆ· |
| `auth.register.submit` | Create Account | åˆ›å»ºè´¦æˆ· |

## Using i18n in Go Code

### Getting a Translator

```go
import "github.com/openhost/openhost/internal/infrastructure/i18n"

// Get default manager
mgr := i18n.Default()

// Get translator for a language
t := mgr.GetTranslator("zh")

// Translate a key
text := t.T("nav.home")  // Returns "é¦–é¡µ"

// Translate with parameters
copyright := t.T("common.copyright", 2024)
```

### Quick Translation

```go
// One-liner translation
text := i18n.T("zh", "nav.home")
```

### Checking Language Support

```go
// Get all available languages
languages := mgr.GetLanguages()
for _, lang := range languages {
    fmt.Printf("%s: %s (%s)\n", lang.Code, lang.Name, lang.NativeName)
}
```

## Using i18n in Gin Handlers

### Setting Language from Request

```go
func (h *Handler) SetLanguageMiddleware() gin.HandlerFunc {
    return func(c *gin.Context) {
        // Check query param
        if lang := c.Query("lang"); lang != "" {
            c.Set("lang", lang)
            c.SetCookie("lang", lang, 86400*30, "/", "", false, false)
        }
        c.Next()
    }
}
```

### Rendering with i18n

The web renderer automatically handles i18n. In handlers, simply call:

```go
func Home(c *gin.Context) {
    web.Render(c, "home.html", gin.H{
        "Title": "Home",
    })
}
```

The template will have access to:
- `.Lang` - Current language code
- `.T` - Translation function
- `{{ t "key" }}` - Template function

## Best Practices

1. **Use namespaces** - Organize translations hierarchically
2. **Avoid hardcoding** - Never hardcode user-facing text
3. **Use parameters** - For dynamic content, use `%s`, `%d`, etc.
4. **Keep translations short** - Especially for UI elements
5. **Test all languages** - Ensure UI works with longer translations
6. **Document keys** - Keep a reference of all translation keys

---

<a name="chinese"></a>
# ç®€ä½“ä¸­æ–‡

## æ¦‚è¿°

OpenHost æä¾›å…¨é¢çš„å›½é™…åŒ–ï¼ˆi18nï¼‰ç³»ç»Ÿï¼Œæ”¯æŒå¤šç§è¯­è¨€ï¼Œå†…ç½®è‹±æ–‡å’Œä¸­æ–‡ç¿»è¯‘ã€‚è¯¥ç³»ç»Ÿè®¾è®¡ä¸ºå¼€å‘äººå‘˜å’Œç¿»è¯‘äººå‘˜éƒ½æ˜“äºä½¿ç”¨ã€‚

## å¿«é€Ÿå¼€å§‹

### åœ¨æ¨¡æ¿ä¸­ä½¿ç”¨ç¿»è¯‘

```html
<!-- ç®€å•ç¿»è¯‘ -->
<h1>{{ t "nav.home" }}</h1>

<!-- å¸¦å‚æ•°çš„ç¿»è¯‘ -->
<p>{{ t "common.copyright" .Year }}</p>
```

### åˆ‡æ¢è¯­è¨€

ç”¨æˆ·å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼åˆ‡æ¢è¯­è¨€ï¼š
- URL å‚æ•°ï¼š`?lang=zh`
- Cookieï¼š`lang=zh`
- Accept-Language è¯·æ±‚å¤´

## æ¶æ„

### ç¿»è¯‘ç»“æ„

ç¿»è¯‘æŒ‰å±‚æ¬¡å‘½åç©ºé—´ç»“æ„ç»„ç»‡ï¼š

```
common.           # é€šç”¨å­—ç¬¦ä¸²
nav.              # å¯¼èˆªæ ‡ç­¾
auth.             # è®¤è¯ç›¸å…³å­—ç¬¦ä¸²
  login.          # ç™»å½•é¡µé¢å­—ç¬¦ä¸²
  register.       # æ³¨å†Œé¡µé¢å­—ç¬¦ä¸²
home.             # é¦–é¡µå†…å®¹
  hero.           # Hero åŒºåŸŸ
  features.       # åŠŸèƒ½åŒºåŸŸ
products.         # äº§å“é¡µé¢
pricing.          # ä»·æ ¼é¡µé¢
cart.             # è´­ç‰©è½¦
checkout.         # ç»“ç®—æµç¨‹
client.           # å®¢æˆ·é¢æ¿
  dashboard.      # å®¢æˆ·æ§åˆ¶é¢æ¿
  services.       # æœåŠ¡ç®¡ç†
  invoices.       # è´¦å•
  tickets.        # å·¥å•æ”¯æŒ
admin.            # ç®¡ç†é¢æ¿
  dashboard.      # ç®¡ç†æ§åˆ¶é¢æ¿
  customers.      # å®¢æˆ·ç®¡ç†
footer.           # é¡µè„šå†…å®¹
errors.           # é”™è¯¯æ¶ˆæ¯
validation.       # è¡¨å•éªŒè¯æ¶ˆæ¯
```

### å†…ç½®è¯­è¨€

OpenHost å†…ç½®ä»¥ä¸‹è¯­è¨€ç¿»è¯‘ï¼š
- **è‹±è¯­ (en)** - é»˜è®¤è¯­è¨€
- **ä¸­æ–‡ (zh)** - ç®€ä½“ä¸­æ–‡

## æ·»åŠ æ–°è¯­è¨€

### ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºç¿»è¯‘æ–‡ä»¶

åœ¨ `internal/infrastructure/i18n/translations_XX.go` åˆ›å»ºæ–°æ–‡ä»¶ï¼Œå…¶ä¸­ XX æ˜¯è¯­è¨€ä»£ç ï¼š

```go
package i18n

func myLanguageTranslations() map[string]any {
    return map[string]any{
        "meta": map[string]any{
            "code":        "XX",
            "name":        "Language Name",
            "native_name": "æœ¬åœ°åç§°",
            "direction":   "ltr",  // æˆ– "rtl"
            "flag":        "ğŸ‡½ğŸ‡½",
        },
        "common": map[string]any{
            "app_name": "OpenHost",
            // ... æ›´å¤šç¿»è¯‘
        },
        // ... æ›´å¤šå‘½åç©ºé—´
    }
}
```

### ç¬¬äºŒæ­¥ï¼šæ³¨å†Œè¯­è¨€

æ›´æ–° `i18n.go` ä»¥åŠ è½½æ‚¨çš„è¯­è¨€ï¼š

```go
func (m *Manager) LoadBuiltinLanguages() error {
    // ... ç°æœ‰ä»£ç 
    if err := m.loadEmbeddedLanguage("XX", myLanguageTranslations()); err != nil {
        return err
    }
    return nil
}
```

## åœ¨ Go ä»£ç ä¸­ä½¿ç”¨ i18n

### è·å–ç¿»è¯‘å™¨

```go
import "github.com/openhost/openhost/internal/infrastructure/i18n"

// è·å–é»˜è®¤ç®¡ç†å™¨
mgr := i18n.Default()

// è·å–ç‰¹å®šè¯­è¨€çš„ç¿»è¯‘å™¨
t := mgr.GetTranslator("zh")

// ç¿»è¯‘é”®
text := t.T("nav.home")  // è¿”å› "é¦–é¡µ"

// å¸¦å‚æ•°ç¿»è¯‘
copyright := t.T("common.copyright", 2024)
```

### å¿«é€Ÿç¿»è¯‘

```go
// ä¸€è¡Œä»£ç ç¿»è¯‘
text := i18n.T("zh", "nav.home")
```

## æœ€ä½³å®è·µ

1. **ä½¿ç”¨å‘½åç©ºé—´** - æŒ‰å±‚æ¬¡ç»„ç»‡ç¿»è¯‘
2. **é¿å…ç¡¬ç¼–ç ** - æ°¸è¿œä¸è¦ç¡¬ç¼–ç é¢å‘ç”¨æˆ·çš„æ–‡æœ¬
3. **ä½¿ç”¨å‚æ•°** - å¯¹äºåŠ¨æ€å†…å®¹ï¼Œä½¿ç”¨ `%s`ã€`%d` ç­‰
4. **ä¿æŒç¿»è¯‘ç®€çŸ­** - ç‰¹åˆ«æ˜¯å¯¹äº UI å…ƒç´ 
5. **æµ‹è¯•æ‰€æœ‰è¯­è¨€** - ç¡®ä¿ UI é€‚ç”¨äºè¾ƒé•¿çš„ç¿»è¯‘
6. **è®°å½•é”®** - ä¿æŒæ‰€æœ‰ç¿»è¯‘é”®çš„å‚è€ƒ

## è®¸å¯è¯

i18n ç³»ç»Ÿéµå¾ª OpenHost çš„ MIT è®¸å¯è¯ã€‚
